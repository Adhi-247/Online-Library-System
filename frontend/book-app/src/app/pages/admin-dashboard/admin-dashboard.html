<main class="max-w-7xl mx-auto px-4 py-8 sm:px-6 lg:px-8 flex">

  <!-- Sidebar -->
  <aside class="w-64 mr-8" id="admin-sidebar">
    <nav class="bg-white rounded-xl shadow-lg p-6 flex flex-col gap-4">
      <button class="admin-tab-btn" [class.active]="activeTab === 'dashboard'" (click)="activeTab = 'dashboard'">Dashboard</button>
      <button class="admin-tab-btn" [class.active]="activeTab === 'books'" (click)="activeTab = 'books'">Books</button>
      <button class="admin-tab-btn" [class.active]="activeTab === 'users'" (click)="activeTab = 'users'">Users</button>
      <button class="admin-tab-btn" [class.active]="activeTab === 'categories'" (click)="activeTab = 'categories'">Categories</button>
      <button class="admin-tab-btn" [class.active]="activeTab === 'loans'" (click)="activeTab = 'loans'">Loans</button>
    </nav>
  </aside>

  <!-- Main Content Area -->
  <section class="flex-1">

    <!-- Books Tab -->
    <div *ngIf="!isLoading && activeTab === 'books'">
      <h2 class="text-2xl font-bold text-slate-800 mb-6 flex items-center gap-2">
        <span>ðŸ“š</span> Manage Books
      </h2>

            <!-- Add Book Form -->
            <form *ngIf="!editingBook" (ngSubmit)="addBook()" #bookForm="ngForm" class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
         <input class="border p-2 rounded" name="title" [(ngModel)]="newBook.title" placeholder="Title" required />
         <input class="border p-2 rounded" name="author" [(ngModel)]="newBook.author" placeholder="Author" required />
         <input class="border p-2 rounded" name="isbn" [(ngModel)]="newBook.isbn" placeholder="ISBN" />
         <input class="border p-2 rounded" name="coverImage" [(ngModel)]="newBook.coverImage" placeholder="Cover Image URL" />
         <input class="border p-2 rounded" name="pages" type="number" [(ngModel)]="newBook.pages" placeholder="Pages" />
         <input class="border p-2 rounded" name="available" type="number" [(ngModel)]="newBook.available" placeholder="Available Copies" />
         <select class="border p-2 rounded" name="categoryId" [(ngModel)]="newBook.categoryId">
           <option [ngValue]="null">Select Category</option>
           <option *ngFor="let cat of categories" [ngValue]="cat.id">{{cat.name}}</option>
         </select>
         <button type="submit" class="col-span-1 md:col-span-2 bg-blue-500 hover:bg-blue-600 text-white rounded-lg py-2 font-semibold">Add Book</button>
            </form>

            <!-- Edit Book Form -->
            <form *ngIf="editingBook" (ngSubmit)="updateBook()" #editBookForm="ngForm" class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
         <input class="border p-2 rounded" name="title" [(ngModel)]="editingBook.title" placeholder="Title" required />
         <input class="border p-2 rounded" name="author" [(ngModel)]="editingBook.author" placeholder="Author" required />
         <input class="border p-2 rounded" name="isbn" [(ngModel)]="editingBook.isbn" placeholder="ISBN" />
         <input class="border p-2 rounded" name="coverImage" [(ngModel)]="editingBook.coverImage" placeholder="Cover Image URL" />
         <input class="border p-2 rounded" name="pages" type="number" [(ngModel)]="editingBook.pages" placeholder="Pages" />
         <input class="border p-2 rounded" name="available" type="number" [(ngModel)]="editingBook.available" placeholder="Available Copies" />
         <select class="border p-2 rounded" name="categoryId" [(ngModel)]="editingBook.categoryId">
           <option [ngValue]="null">Select Category</option>
           <option *ngFor="let cat of categories" [ngValue]="cat.id">{{cat.name}}</option>
         </select>
         <button type="submit" class="col-span-1 md:col-span-2 bg-blue-500 hover:bg-blue-600 text-white rounded-lg py-2 font-semibold">Update Book</button>
         <button type="button" (click)="cancelEdit()" class="col-span-1 md:col-span-2 bg-gray-400 hover:bg-gray-500 text-white rounded-lg py-2 font-semibold mt-2">Cancel</button>
            </form>

      <!-- Table -->
      <div class="overflow-x-auto">
        <table class="min-w-full bg-white border rounded-xl">
          <thead>
            <tr>
              <th class="py-2 px-4 border-b">Title</th>
              <th class="py-2 px-4 border-b">Author</th>
              <th class="py-2 px-4 border-b">Category</th>
              <th class="py-2 px-4 border-b">Available</th>
              <th class="py-2 px-4 border-b">Actions</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let book of books">
              <td class="py-2 px-4 border-b">{{book.title}}</td>
              <td class="py-2 px-4 border-b">{{book.author}}</td>
              <td class="py-2 px-4 border-b">{{book.category?.name || 'Uncategorized'}}</td>
              <td class="py-2 px-4 border-b">{{book.available}}</td>
              <td class="py-2 px-4 border-b">
                <button (click)="editBook(book)"
                        class="bg-yellow-400 hover:bg-yellow-500 text-white rounded px-3 py-1 mr-2">
                  Edit
                </button>
                <button (click)="deleteBook(book.id)"
                        class="bg-red-500 hover:bg-red-600 text-white rounded px-3 py-1">
                  Delete
                </button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>

    </div>

  </section>

</main>
